from itertools import chainfrom modular.mysql_connect import connect_db, connect_dh_alchemyfrom modular.sqlserve_connect import serverConnect_db# wmsdb = "ods_mysql"class connect_DB(object):    __instance = None    def __new__(cls, *args, **kwargs):        # 类对象唯一        if cls.__instance is None:            cls.__instance = super(connect_DB, cls).__new__(cls)        return cls.__instance    def __init__(self, wms_db="ods_mysql"):        # wmsdb = connect_db(wmsdb="ods_mysql")        self.wmsdb = connect_db(wms_db)        self.cursor = self.wmsdb.cursor()        # return self.cursor    def execute(self, sql):        self.cursor.execute(sql)    def fetchone(self, sql,type=dict):        self.execute(sql)        dict_result = self.cursor.fetchone()        if type==dict:            return dict_result        # else:        #     return list(chain.from_iterable(dict_result))    def fetchall(self,sql,type=dict):        self.execute(sql)        dict_result = self.cursor.fetchall()        if type==dict:            return   dict_result        # else:        #     return list(chain.from_iterable(dict_result))    def commit(self):        self.wmsdb.commit()    def close(self):        self.wmsdb.close()        pass    def executeAndcommit(self,sql):        self.cursor.execute(sql)        self.wmsdb.commit()    def commitAndClose(self):        self.commit()        self.close()class ConnectWSPdb(connect_DB):    __instance = None    def __new__(cls, *args, **kwargs):        # 类对象唯一        if cls.__instance is None:            cls.__instance = super(ConnectWSPdb, cls).__new__(cls)        return cls.__instance    def __init__(self, wms_db="wsp_mysql"):        self.wmsdb = connect_db(wms_db)        self.cursor = self.wmsdb.cursor()class connect_sqlserve(object):    __instance = None    def __init__(self, server_db='sql_servetest'):        # wmsdb = connect_db(wmsdb="ods_mysql")        self.wmsdb = serverConnect_db(server_db)        # self.cursor = self.wmsdb.cursor()        self.cursor = self.wmsdb.cursor(as_dict=True)        # return self.cursor    def __new__(cls,server_db='sql_servetest'):        # 类对象唯一        # if not hasattr(connect_sqlserve,"_instance"):        if cls.__instance is None:            cls.__instance = super(connect_sqlserve,cls).__new__(cls)        return cls.__instance    def execute(self, sql):        self.cursor.execute(sql)    def fetchone(self, sql):        self.execute(sql)        return self.cursor.fetchone()    def fetchall(self, sql):        self.execute(sql)        return self.cursor.fetchall()    def commit(self):        self.wmsdb.commit()    def close(self):        self.wmsdb.close()        pass    def executeAndcommit(self,sql):        self.cursor.execute(sql)        self.wmsdb.commit()    def commitAndClose(self):        self.commit()        self.close()class ConnectDBbySqlAchmey(object):    # __instance = None    # def __new__(cls, *args, **kwargs):    #     # 类对象唯一    #     if cls.__instance is None:    #         cls.__instance = super(ConnectDBbySqlAchmey, cls).__new__(cls)    #     return cls.__instance    def __init__(self, wms_db="ods_mysql"):        # wmsdb = connect_db(wmsdb="ods_mysql")        self.wmsdb = connect_dh_alchemy(wms_db)        self.cursor = self.wmsdb()        # return self.cursor    def execute(self, sql):        self.cursor.execute(sql)    def fetchone(self, sql,type=dict):        self.execute(sql)        dict_result = self.cursor.fetchone()        if type==dict:            return dict_result        # else:        #     return list(chain.from_iterable(dict_result))    def fetchall(self,sql,type=dict):        self.execute(sql)        dict_result = self.cursor.fetchall()        if type==dict:            return   dict_result        # else:        #     return list(chain.from_iterable(dict_result))    def commit(self):        self.wmsdb.commit()    def close(self):        self.wmsdb.close()        pass    def executeAndcommit(self,sql):        self.cursor.execute(sql)        self.wmsdb.commit()    def commitAndClose(self):        self.commit()        self.close()    def __del__(self):        self.close()class ConnectWSPdb(connect_DB):    __instance = None    def __new__(cls, *args, **kwargs):        # 类对象唯一        if cls.__instance is None:            cls.__instance = super(ConnectWSPdb, cls).__new__(cls)        return cls.__instance    def __init__(self, wms_db="wsp_mysql"):        self.wmsdb = connect_db(wms_db)        self.cursor = self.wmsdb.cursor()class connect_sqlserve(object):    __instance = None    def __init__(self, server_db='sql_servetest'):        # wmsdb = connect_db(wmsdb="ods_mysql")        self.wmsdb = serverConnect_db(server_db)        # self.cursor = self.wmsdb.cursor()        self.cursor = self.wmsdb.cursor(as_dict=True)        # return self.cursor    def __new__(cls,server_db='sql_servetest'):        # 类对象唯一        # if not hasattr(connect_sqlserve,"_instance"):        if cls.__instance is None:            cls.__instance = super(connect_sqlserve,cls).__new__(cls)        return cls.__instance    def execute(self, sql):        self.cursor.execute(sql)    def fetchone(self, sql):        self.execute(sql)        return self.cursor.fetchone()    def fetchall(self, sql):        self.execute(sql)        return self.cursor.fetchall()    def commit(self):        self.wmsdb.commit()    def close(self):        self.wmsdb.close()        pass    def executeAndcommit(self,sql):        self.cursor.execute(sql)        self.wmsdb.commit()    def commitAndClose(self):        self.commit()        self.close()